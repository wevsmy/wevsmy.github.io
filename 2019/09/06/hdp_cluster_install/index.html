<!DOCTYPE html>
<html lang="zh-cn" >
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    




<link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">





<link rel="stylesheet" type="text/css" href="https://at.alicdn.com/t/font_1354893_48p2lem7d2u.css">



<link rel="stylesheet" type="text/css" href="/css/weii.css">




    
    <meta name="theme-color" content="#333333">
    <meta name="msapplication-TileColor" content="#333333">
    
    
    
    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?cd78dad41ad2de68dddcbff91c704ce4";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    
    
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-146915278-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-146915278-1');
    </script>
    
    
    <meta name="google-site-verification" content="LY-yWUgw7WEmNuBW7lLOj8jSiKZEVgOCmsisfGWtZCg">
    
    
    <meta name="msvalidate.01" content="1A54BC0D6A4D102B72F2A0E9870611FA"/>
    
    
    
    
    <meta name="keywords"
          content="HDP, hadoop, jdk, java, centos, cloudera, manager, bigdata, å¤§æ•°æ®å¹³å°"/>
    
    
    
    <meta name="description" content="hadoopé›†ç¾¤å®‰è£…è®°å½•,å¤§æ•°æ®å¹³å° | HDP(2.6.5)é›†ç¾¤å®‰è£…è®°å½•">
    
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png"/>
    
    
    <link rel="icon" type="image/png" sizes="192x192"
          href="/favicons/android-chrome-96x96.png">
    
    
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    
    
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    
    
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg"
          color="#333333">
    
    
    <link rel="manifest" href="/favicons/site.webmanifest">
    
    
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicons/favicon.ico">
    

    <title>HDP(2.6.5)é›†ç¾¤å®‰è£…è®°å½•</title>

    
    



<script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>





<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</head>

<body>

<header id="header" class="header" 
        style="background: #333333;" >
    <div class="container">
        <div class="header-container">
            <div class="header-title">
                <h1 class="title">
                    <a href="/">
                        wilson&#39;s blog
                    </a>
                </h1>
                <h2 class="subtitle">
                    Life is short, you need Python
                </h2>
            </div>
            
            <div class="logo">
                <img src="/images/logo.png" alt="logo">
            </div>
            
        </div>

        
        <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">

                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Modal title</h4>
                    </div>
                    <div class="modal-body">
                        <p>One fine body&hellip;</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>

                </div>
            </div>
        </div>

        
        <nav class="navbar navbar-inverse header-nav">
            <div class="container-fluid">
                
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                            data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    
                    <a class="navbar-brand" href="#" data-toggle="tooltip" data-placement="top"
                       title="( âŠ™ o âŠ™ )å•Šï¼">å¯¼èˆª</a>
                </div>
                
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        
                        <li><a href="/">
                            
                            <i class="iconfont iconhome"></i>
                            
                            <span class="menu-text">é¦–é¡µ</span>
                        </a></li>
                        
                        <li><a href="/posts/">
                            
                            <i class="iconfont iconfolder-open"></i>
                            
                            <span class="menu-text">å½’æ¡£</span>
                        </a></li>
                        
                        <li><a href="/categories/">
                            
                            <i class="iconfont iconbook"></i>
                            
                            <span class="menu-text">åˆ†ç±»</span>
                        </a></li>
                        
                        <li><a href="/tags/">
                            
                            <i class="iconfont icontags"></i>
                            
                            <span class="menu-text">æ ‡ç­¾</span>
                        </a></li>
                        
                        <li><a href="/about/">
                            
                            <i class="iconfont iconsolution"></i>
                            
                            <span class="menu-text">å…³äº</span>
                        </a></li>
                        
                    </ul>
                    <div class="navbar-form navbar-right">
                        <div class="form-group">
                            <input type="search" id="search-input" name="q" results="0"
                                   placeholder="(à¸…Â´Ï‰`à¸…)" class="form-control"/>
                        </div>
                    </div>
                    <div class="search-result-box" id="search-result"></div>
                </div>
            </div>
        </nav>
    </div>
</header>

<main id="main" class="main">
    <div class="container">
        <div class="main-container">
            <div id="content" class="content">
                
                
                
                
<div class="panel panel-default post-panel">
    <div class="panel-heading post-head">
        <div class="post-title"><h2><a href='/2019/09/06/hdp_cluster_install/'>HDP(2.6.5)é›†ç¾¤å®‰è£…è®°å½•</a></h2></div>
        <div class="post-meta"><span>2019.09.06</span></div>
    </div>
    <div class="panel-body post-body">
        <div class="post-post" id="post-post">
            <p>HDP(2.6.5)é›†ç¾¤å®‰è£…è®°å½•</p>

<h1 id="hdp-2-6-5-é›†ç¾¤å®‰è£…è®°å½•">HDP(2.6.5)é›†ç¾¤å®‰è£…è®°å½•</h1>

<h2 id="ç½‘ç»œé…ç½®-æ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œ">ç½‘ç»œé…ç½®(æ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œ)</h2>

<pre><code class="language-txt">| hostname |      IP       |  è¯´æ˜  |
| :------: | :-----------: | :----: |
|  hdp01   | 172.31.66.32  | master |
|  hdp02   | 172.31.66.34  | node1  |
|  hdp03   | 172.31.66.170 | node2  |
</code></pre>

<p><strong>æ£€æŸ¥ip</strong></p>

<pre><code class="language-shell">ifconfig
</code></pre>

<p><strong>æ›´æ”¹hostname</strong></p>

<pre><code class="language-shell">vim /etc/hostname
</code></pre>

<p>å°†localhostæ›´æ”¹æˆè¡¨æ ¼ä¸­çš„hostname(æ ¹æ®ä¸šåŠ¡è‡ªè¡Œå®šä¹‰)</p>

<p><strong>æ›´æ”¹SELINUX</strong></p>

<pre><code class="language-shell">vim /etc/sysconfig/selinux
#ä¿®æ”¹ä»¥ä¸‹å†…å®¹
SELINUX=disabled
</code></pre>

<p><strong>é‡å¯æœåŠ¡å™¨</strong></p>

<pre><code class="language-shell">reboot
</code></pre>

<p><strong>ä¿®æ”¹hostsæ–‡ä»¶</strong></p>

<pre><code class="language-shell">vim /etc/hosts
</code></pre>

<p>å¯¹åº”ä¸Šè¡¨hostname,ä¸ºhostsæ–‡ä»¶æ·»åŠ è·¯ç”±</p>

<p><strong>SSHå…å¯†ç™»å½•</strong></p>

<pre><code class="language-shell">ssh-keygen
#enter
</code></pre>

<p>å¤åˆ¶ç”Ÿæˆçš„å…¬é’¥åˆ°æ¯ä¸ªèŠ‚ç‚¹(ä¸»èŠ‚ç‚¹æ‰§è¡Œ)</p>

<pre><code class="language-shell">scp /root/.ssh/id_rsa.put hdop02:/tmp/
#é™¤masterå¤–éƒ½éœ€è¦æŒ‡å‘æ‰§è¡Œ
</code></pre>

<p><strong>å…¶ä»–èŠ‚ç‚¹æ‰§è¡Œ</strong></p>

<pre><code class="language-shell">cat /tmp/id_rsa.pub &gt;&gt;/root/.ssh/authorized_keys
</code></pre>

<p>æ£€æŸ¥ä¸€å“ˆ</p>

<p><strong>å…³é—­é˜²ç«å¢™</strong></p>

<pre><code class="language-shell">systemctl stop firewalld.service
systemctl disable firewalld.service
</code></pre>

<p><strong>å¼€å¯ntpæœåŠ¡</strong></p>

<pre><code class="language-shell">yum install -y ntp
systemctl enble ntpd
systemctl start ntpd
</code></pre>

<h2 id="å®‰è£…jdk">å®‰è£…JDK</h2>

<p><strong>ä¸‹è½½jdk</strong></p>

<p><a href="https://www.oracle.com/technetwork/cn/java/javase/downloads/jdk8-downloads-2133151-zhs.html">jdk8 ä¸‹è½½</a></p>

<p>åœ¨å½“å‰ç›®å½•æ‰“å¼€shell</p>

<pre><code class="language-shell">tar -zxvf jdk-8u181-linux-x64.tar.gz -C /opt/java/
vi /etc/profile

export JAVA_HOME=/opt/java/jdk1.8.0_181
export JRE_HOE=$JAVA_HOME/jre
export CLASSPATH=.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib
export PATH=$PATH:$JAVA_HOME/bin
</code></pre>

<p>è¿œç¨‹åˆ†å‘åˆ°å…¶ä»–æœåŠ¡å™¨</p>

<pre><code class="language-shell">scp -r /opt/java/jdk1.8.0_181/ root@hdp02:/opt/java/
scp -r /opt/java/jdk1.8.0_181/ root@hdp03:/opt/java/

scp /etc/profile root@hdp02:/etc/
scp /etc/profile root@hdp03:/etc/

source /etc/profile
</code></pre>

<h2 id="ambariå®‰è£…">Ambariå®‰è£…</h2>

<p><strong>ä¸‹è½½èµ„æºå®‰è£…åŒ…</strong></p>

<pre><code class="language-shell">wget http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.2.0/ambari-2.6.2.0-centos7.tar.gz
wget http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0/HDP-2.6.5.0-centos7-rpm.tar.gz
wget http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.22/repos/centos7/HDP-UTILS-1.1.0.22-centos7.tar.gz
wget http://public-repo-1.hortonworks.com/HDP-GPL/centos7/2.x/updates/2.6.5.0/HDP-GPL-2.6.5.0-centos7-gpl.tar.gz
</code></pre>

<p><strong>å®‰è£…Apache HTTP æœåŠ¡å™¨</strong></p>

<pre><code class="language-shell">yum install httpd -y
#å¼€å¯æœåŠ¡å¹¶è®¾ç½®å¼€æœºè‡ªå¯åŠ¨
systemctl start httpd.service
systemctl enable httpd.service
</code></pre>

<p><strong>å®‰è£…åˆ¶ä½œyumæº</strong></p>

<pre><code class="language-shell">yum install yum-utils createrepo
</code></pre>

<p><strong>åˆ›å»ºhttpæœåŠ¡å™¨</strong></p>

<p>httpæ ¹ç›®å½•é»˜è®¤æ˜¯å³/var/www/html/</p>

<pre><code class="language-shell">mkdir -p /var/www/html/ambari
#cd /var/www/html/ambari
#å°†ä¸‹è½½å¥½çš„å®‰è£…åŒ…ä¸Šä¼ å¹¶è§£å‹
tar xvf HDP-2.6.5.0-centos7-rpm.tar.gz -C /var/www/html/ambari
tar xvf ambari-2.6.2.0-centos7.tar.gz -C /var/www/html/ambari
tar xvf HDP-UTILS-1.1.0.22-centos7.tar.gz -C /var/www/html/ambari
tar xvf HDP-GPL-2.6.5.0-centos7-gpl.tar.gz -C /var/www/html/ambari

# åˆ é™¤å‹ç¼©åŒ…
rm -rf ambari-2.6.2.0-centos7.tar.gz
rm -rf HDP-2.6.5.0-centos7-rpm.tar.gz
rm -rf HDP-UTILS-1.1.0.22-centos7.tar.gz
rm -rf HDP-GPL-2.6.5.0-centos7-gpl.tar.gz
</code></pre>

<p>éªŒè¯ä¸€å“ˆ</p>

<p><img src="/static/posts/hdp_cluster_install/1.png" alt="éªŒè¯ä¸€å“ˆ" /></p>

<p><strong>é…ç½®ambariã€HDPã€HDP-UTILSçš„æœ¬åœ°æº</strong></p>

<pre><code class="language-shell">cd /etc/yum.repos.d/
wget http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.2.0/ambari.repo
wget http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0/hdp.repo
wget http://public-repo-1.hortonworks.com/HDP-GPL/centos7/2.x/updates/2.6.5.0/hdp.gpl.repo
</code></pre>

<p>ç¼–è¾‘ambari.repoï¼Œä¿®æ”¹baseurlå’Œgpgkey</p>

<pre><code class="language-shell">[root@hdc-data1 yum.repos.d]# vi ambari.repo 

#IPå‡ä¸ºä¸»èŠ‚ç‚¹IP,ä»¥ä¸‹å‘½ä»¤éœ€å˜æ›´IP
#VERSION_NUMBER=2.6.2.0-155
[ambari-2.6.2.0]
name=ambari Version - ambari-2.6.2.0
#baseurl=http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.2.0
baseurl=http://master/ambari/ambari/centos7/2.6.2.0-155
gpgcheck=1
#gpgkey=http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.2.0/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
gpgkey=http://master/ambari/ambari/centos7/2.6.2.0-155/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled=1
priority=1
</code></pre>

<p>ç¼–è¾‘hdp.repoï¼Œä¿®æ”¹baseurlå’Œgpgkey</p>

<p><strong>IPå‡ä¸ºä¸»èŠ‚ç‚¹IP</strong></p>

<pre><code class="language-shell">[root@hdc-data1 yum.repos.d]# vi hdp.repo 

#VERSION_NUMBER=2.6.5.0-292
[HDP-2.6.5.0]
name=HDP Version - HDP-2.6.5.0
#baseurl=http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0
baseurl=http://master/ambari/HDP/centos7/2.6.5.0-292
gpgcheck=1
#gpgkey=http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
gpgkey=http://master/ambari/HDP/centos7/2.6.5.0-292/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled=1
priority=1


[HDP-UTILS-1.1.0.22]
name=HDP-UTILS Version - HDP-UTILS-1.1.0.22
#baseurl=http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.22/repos/centos7
baseurl=http://master/ambari/HDP-UTILS/centos7/1.1.0.22
gpgcheck=1
#gpgkey=http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.5.0/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
gpgkey=http://master/ambari/HDP-UTILS/centos7/1.1.0.22/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled=1
priority=1
</code></pre>

<p>ç¼–è¾‘hdp.gpl.repoï¼Œä¿®æ”¹baseurlå’Œgpgkey</p>

<pre><code class="language-shell">[root@hdc-data1 yum.repos.d]# vi hdp.gpl.repo 

#VERSION_NUMBER=2.6.5.0-292
[HDP-GPL-2.6.5.0]
name=HDP-GPL Version - HDP-GPL-2.6.5.0
#baseurl=http://public-repo-1.hortonworks.com/HDP-GPL/centos7/2.x/updates/2.6.5.0
baseurl=http://master/ambari/HDP-GPL/centos7/2.6.5.0-292
gpgcheck=1
#gpgkey=http://public-repo-1.hortonworks.com/HDP-GPL/centos7/2.x/updates/2.6.5.0/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
gpgkey=http://master/ambari/HDP-GPL/centos7/2.6.5.0-292/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled=1
priority=1
</code></pre>

<p>åˆ†å‘åˆ°å…¶ä»–æœºå™¨</p>

<pre><code class="language-shell">scp /etc/yum.repos.d/ambari.repo root@hdp02:/etc/yum.repos.d/
scp /etc/yum.repos.d/ambari.repo root@hdp03:/etc/yum.repos.d/
scp /etc/yum.repos.d/hdp.repo root@hdp02:/etc/yum.repos.d/
scp /etc/yum.repos.d/hdp.repo root@hdp03:/etc/yum.repos.d/
scp /etc/yum.repos.d/hdp.gpl.repo root@hdp02:/etc/yum.repos.d/
scp /etc/yum.repos.d/hdp.gpl.repo root@hdp03:/etc/yum.repos.d/
</code></pre>

<p>æ¯å°æœºå™¨yumé…ç½®</p>

<pre><code class="language-shell">yum clean all
yum makecache
yum list
</code></pre>

<h2 id="å®‰è£…mysql">å®‰è£…Mysql</h2>

<p><strong>å®‰è£…åŠåˆå§‹åŒ–è®¾ç½®</strong></p>

<pre><code class="language-shell">[root@hdc-data1 ~]# yum install mariadb-server
[root@hdc-data1 ~]# systemctl start mariadb
[root@hdc-data1 ~]# systemctl enable mariadb
[root@hdc-data1 ~]# mysql_secure_installation

#é¦–å…ˆæ˜¯è®¾ç½®å¯†ç ï¼Œä¼šæç¤ºå…ˆè¾“å…¥å¯†ç 
Enter current password for root (enter for none):&lt;â€“åˆæ¬¡è¿è¡Œç›´æ¥å›è½¦
#è®¾ç½®å¯†ç 
Set root password? [Y/n] &lt;â€“ æ˜¯å¦è®¾ç½®rootç”¨æˆ·å¯†ç ï¼Œè¾“å…¥yå¹¶å›è½¦æˆ–ç›´æ¥å›è½¦
New password: &lt;â€“ è®¾ç½®rootç”¨æˆ·çš„å¯†ç 
Re-enter new password: &lt;â€“ å†è¾“å…¥ä¸€æ¬¡ä½ è®¾ç½®çš„å¯†ç 
#å…¶ä»–é…ç½®
Remove anonymous users? [Y/n] &lt;â€“ æ˜¯å¦åˆ é™¤åŒ¿åç”¨æˆ·ï¼Œå›è½¦
Disallow root login remotely? [Y/n] &lt;â€“æ˜¯å¦ç¦æ­¢rootè¿œç¨‹ç™»å½•,å›è½¦,
Remove test database and access to it? [Y/n] &lt;â€“ æ˜¯å¦åˆ é™¤testæ•°æ®åº“ï¼Œå›è½¦
Reload privilege tables now? [Y/n] &lt;â€“ æ˜¯å¦é‡æ–°åŠ è½½æƒé™è¡¨ï¼Œå›è½¦
</code></pre>

<p><strong>å®‰è£…å®Œæˆååˆ›å»ºambariæ•°æ®åº“åŠç”¨æˆ·</strong></p>

<pre><code class="language-shell">#è¿›å…¥mysql shell
mysql -uroot -p
</code></pre>

<pre><code class="language-mysql">create database ambari character set utf8 ;  
CREATE USER 'ambari'@'%'IDENTIFIED BY 'ambari123';
GRANT ALL PRIVILEGES ON *.* TO 'ambari'@'%';
FLUSH PRIVILEGES;
</code></pre>

<p>å¦‚æœè¦å®‰è£…Hiveï¼Œåˆ›å»ºHiveæ•°æ®åº“å’Œç”¨æˆ·</p>

<pre><code class="language-mysql">create database hive character set utf8 ;  
CREATE USER 'hive'@'%'IDENTIFIED BY 'hive123';
GRANT ALL PRIVILEGES ON *.* TO 'hive'@'%';
FLUSH PRIVILEGES;
</code></pre>

<p>å¦‚æœè¦å®‰è£…Oozieï¼Œåˆ›å»ºOozieæ•°æ®åº“å’Œç”¨æˆ·</p>

<pre><code class="language-mysql">create database oozie character set utf8 ;  
CREATE USER 'oozie'@'%'IDENTIFIED BY 'oozie123';
GRANT ALL PRIVILEGES ON *.* TO 'oozie'@'%';
FLUSH PRIVILEGES;
</code></pre>

<p><strong>å®‰è£…ambari</strong></p>

<pre><code class="language-shell">yum install ambari-server
</code></pre>

<p><strong>ä¸‹è½½mysqlé©±åŠ¨</strong>
<a href="http://central.maven.org/maven2/mysql/mysql-connector-java/5.1.40/">mysql-connector-java ä¸‹è½½</a>
å°†mysql-connector-Java.jarå¤åˆ¶åˆ°/usr/share/javaç›®å½•ä¸‹</p>

<pre><code class="language-shell">mkdir /usr/share/java
cp mysql-connector-java-5.1.40.jar /usr/share/java/mysql-connector-java.jar
</code></pre>

<p>å°†mysql-connector-java.jarå¤åˆ¶åˆ°/var/lib/ambari-server/resourcesç›®å½•ä¸‹</p>

<pre><code class="language-shell">cp mysql-connector-java-5.1.40.jar /var/lib/ambari-server/resources/mysql-jdbc-driver.jar
</code></pre>

<p><strong>ç¼–è¾‘/etc/ambari-server/conf/ambari.propertiesï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹</strong></p>

<pre><code class="language-shell">server.jdbc.driver.path=/usr/share/java/mysql-connector-java.jar
#ã€å¯é€‰ã€‘ä¿®æ”¹é»˜è®¤8080ç«¯å£
#client.api.port=18080
</code></pre>

<p><strong>ambariaåˆå§‹åŒ–</strong></p>

<pre><code class="language-shell">#è®¾ç½®mysqlé©±åŠ¨
ambari-server setup --jdbc-db=mysql --jdbc-driver=/usr/share/java/mysql-connector-java.jar 
ambari-server setup
</code></pre>

<p>å®Œæ•´åˆå§‹åŒ–å¦‚ä¸‹ï¼š</p>

<pre><code class="language-shell">[root@hdc-data1 ~]# ambari-server setup
Using python  /usr/bin/python
Setup ambari-server
Checking SELinux...
SELinux status is 'disabled'
Customize user account for ambari-server daemon [y/n] (n)? y
Enter user account for ambari-server daemon (root):
Adjusting ambari-server permissions and ownership...
Checking firewall status...
Checking JDK...
[1] Oracle JDK 1.8 + Java Cryptography Extension (JCE) Policy Files 8
[2] Oracle JDK 1.7 + Java Cryptography Extension (JCE) Policy Files 7
[3] Custom JDK
==============================================================================
Enter choice (1): 3
WARNING: JDK must be installed on all hosts and JAVA_HOME must be valid on all hosts.
WARNING: JCE Policy files are required for configuring Kerberos security. If you plan to use Kerberos,please make sure JCE Unlimited Strength Jurisdiction Policy Files are valid on all hosts.
Path to JAVA_HOME: /opt/java/jdk1.8.0_181
Validating JDK on Ambari Server...done.
Checking GPL software agreement...
GPL License for LZO: https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html
Enable Ambari Server to download and install GPL Licensed LZO packages [y/n] (n)? y
Completing setup...
Configuring database...
Enter advanced database configuration [y/n] (n)? y
Configuring database...
==============================================================================
Choose one of the following options:
[1] - PostgreSQL (Embedded)
[2] - Oracle
[3] - MySQL / MariaDB
[4] - PostgreSQL
[5] - Microsoft SQL Server (Tech Preview)
[6] - SQL Anywhere
[7] - BDB
==============================================================================
Enter choice (1): 3
Hostname (localhost): 
Port (3306): 
Database name (ambari): 
Username (ambari): 
Enter Database Password (bigdata): 
Re-enter password: 
Configuring ambari database...
Configuring remote database connection properties...
WARNING: Before starting Ambari Server, you must run the following DDL against the database to create the schema: /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql
Proceed with configuring remote database connection properties [y/n] (y)? y
Extracting system views...
.....ambari-admin-2.6.2.0.155.jar
......
Adjusting ambari-server permissions and ownership...
Ambari Server 'setup' completed successfully.
</code></pre>

<p><strong>å°†Ambariæ•°æ®åº“è„šæœ¬å¯¼å…¥åˆ°æ•°æ®åº“</strong></p>

<pre><code class="language-shell">#ç”¨Ambariç”¨æˆ·ï¼ˆä¸Šé¢è®¾ç½®çš„ç”¨æˆ·ï¼‰ç™»å½•mysql
mysql -u ambari -p
use ambari;
source /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql
</code></pre>

<p><strong>å¯åŠ¨Ambari</strong></p>

<pre><code class="language-shell">ambari-server start
</code></pre>

<h2 id="webuié…ç½®">WebUIé…ç½®</h2>

<p>å›¾æˆªå¾—æœ‰ç‚¹ç³Š&hellip;</p>

<p><img src="/static/posts/hdp_cluster_install/2.png" alt="WebUI" /></p>

<p>åˆ›å»ºé›†ç¾¤åç§°</p>

<p><img src="/static/posts/hdp_cluster_install/3.png" alt="WebUI" /></p>

<p>é€‰æ‹©HDPç‰ˆæœ¬å’Œé€‰æ‹©æœ¬åœ°ä»“åº“</p>

<p><img src="/static/posts/hdp_cluster_install/4.png" alt="WebUI" /></p>

<p>é…ç½®HDPçš„Repository</p>

<p><img src="/static/posts/hdp_cluster_install/5.png" alt="WebUI" /></p>

<p>è¾“å…¥é›†ç¾¤èŠ‚ç‚¹host(FQDN)å’ŒAmbarièŠ‚ç‚¹SSHçš„ç§é’¥</p>

<p><img src="/static/posts/hdp_cluster_install/6.png" alt="WebUI" /></p>

<p>ç­‰å¾…ambari-agentsæ³¨å†Œ</p>

<p><img src="/static/posts/hdp_cluster_install/7.png" alt="WebUI" /></p>

<p>è‹¥æŠ¥é”™</p>

<p><img src="/static/posts/hdp_cluster_install/8.png" alt="WebUI" /></p>

<p><img src="/static/posts/hdp_cluster_install/9.png" alt="WebUI" /></p>

<p>ã€é‡åˆ°é—®é¢˜ Confirm Hostsã€‘
 æ³¨å†Œambari-agentsæ—¶failed
 NetUtil.py:96 - EOF occurred in violation of protocol (_ssl.c:579)
 SSLError: Failed to connect. Please check openssl library versions.
 è§£å†³ï¼šå¦‚ä¸‹ç¬¬ä¸‰ä¸ªæ–¹æ¡ˆï¼Œ/etc/ambari-agent/conf/ambari-agent.iniæ–‡ä»¶åªæœ‰æ‰§è¡Œè¯¥æ­¥éª¤è¿›è¡Œæ³¨å†Œæ‰ç”Ÿæˆã€‚ä¿®æ”¹åç‚¹å‡»â€œRetry Failedâ€æŒ‰é’®ï¼Œç­‰å¾…æ³¨å†ŒæˆåŠŸè¿›å…¥ä¸‹ä¸€æ­¥ã€‚</p>

<p>æ³¨:æ— æŠ¥é”™æ—¶æ— æ­¤æ–‡ä»¶,éœ€æŠ¥é”™åå†è¡Œå¤„ç†</p>

<pre><code class="language-shell"># 1ã€yum upgrade openssl å·²æ˜¯æœ€æ–°æœ¬ç‰ˆï¼Œæœªè§£å†³
# 2ã€vi /etc/python/cert-verification.cfg ä¿®æ”¹ verify=disableï¼Œæœªè§£å†³
[https]
#verify=platform_default
verify=disable
# 3ã€æœ€åè§£å†³æ–¹æ¡ˆ åœ¨ambari-agentçš„é…ç½®æ–‡ä»¶/etc/ambari-agent/conf/ambari-agent.ini
 åœ¨ ï¼»securityï¼½æ ‡ç­¾ä¸‹é¢å¢åŠ ä¸€é¡¹
[security]
force_https_protocol=PROTOCOL_TLSv1_2
</code></pre>

<p><img src="/static/posts/hdp_cluster_install/10.png" alt="WebUI" /></p>

<p>é€‰æ‹©å®‰è£…ç»„ä»¶ï¼Œï¼ˆæœ€å°åŒ–å®‰è£…HDFS+YARN+MAPREDUCE2+Ambari Metrics+SmartSense+ZooKeeper+Hbaseï¼‰</p>

<p>ä¸å¿…è¦çš„ç»„ä»¶å¯ä»¥æš‚æ—¶ä¸å®‰è£…èŠ‚çœå®‰è£…æ—¶é—´ï¼Œåç»­å¯ä»¥å†æ·»åŠ å®‰è£…ç»„ä»¶</p>

<p><img src="/static/posts/hdp_cluster_install/11.png" alt="WebUI" /></p>

<p><img src="/static/posts/hdp_cluster_install/12.png" alt="WebUI" /></p>

<p>å®é™…éƒ¨ç½²æ—¶éœ€æŒ‰è§„åˆ’è®¾è®¡è¿›è¡Œåˆ†é…ï¼ˆæ³¨æ„ï¼šHbase HA çš„è¯åœ¨Hbase Master ç‚¹å‡»åé¢çš„å°ç»¿è‰²+å·ï¼Œæ·»åŠ standby masterï¼‰ï¼š</p>

<p><img src="/static/posts/hdp_cluster_install/13.png" alt="WebUI" /></p>

<p>å·¥ä½œèŠ‚ç‚¹è§’è‰²åˆ†é…(ç”Ÿäº§ç¯å¢ƒå…¨å‹¾äº†)</p>

<p><img src="/static/posts/hdp_cluster_install/14.png" alt="WebUI" /></p>

<p>ç»„ä»¶é…ç½®ä¿¡æ¯ä¿®æ”¹
é€šå¸¸æ•°æ®ç›®å½•ä¿®æ”¹åˆ°/data/ç›®å½•ä¸‹ï¼Œæœ‰çº¢è‰²ä¿¡æ¯æç¤ºçš„ç»„ä»¶è¡¨ç¤ºè¦è¾“å…¥ç›¸åº”çš„è´¦å·å¯†ç ã€‚ä»¥ä¸‹ç¤ºä¾‹ï¼Œå¯æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µé…ç½®ã€‚</p>

<p>HDFS</p>

<p><img src="/static/posts/hdp_cluster_install/15.png" alt="WebUI" /></p>

<p><img src="/static/posts/hdp_cluster_install/16.png" alt="WebUI" /></p>

<p>HIVE,è‹¥æ•°æ®åº“ç«¯å£ä¿®æ”¹æŒ‰å®é™…å¡«å†™</p>

<p><img src="/static/posts/hdp_cluster_install/17.png" alt="WebUI" /></p>

<p>Oozie</p>

<p><img src="/static/posts/hdp_cluster_install/18.png" alt="WebUI" /></p>

<p>Zookeeper</p>

<p><img src="/static/posts/hdp_cluster_install/19.png" alt="WebUI" /></p>

<p><img src="/static/posts/hdp_cluster_install/20.png" alt="WebUI" /></p>

<p><img src="/static/posts/hdp_cluster_install/21.png" alt="WebUI" /></p>

<p><img src="/static/posts/hdp_cluster_install/22.png" alt="WebUI" /></p>

<p>æš‚æ—¶ä¿®æ”¹äº†ä»¥ä¸‹å±æ€§ï¼Œå…·ä½“é…ç½®ä¿¡æ¯å¯æ ¹æ®å®é™…æƒ…å†µåç»­ç›¸åº”ä¿®æ”¹</p>

<pre><code class="language-text">| ç«¯å£å±æ€§                                  | ä¿®æ”¹å€¼                                |
| :---------------------------------------- | :------------------------------------ |
| dfs.namenode.http-address                 | octserver1.hadoop:50770 ï¼ˆdef:50070ï¼‰ |
| yarn.resourcemanager.webapp.address       | octserver2.hadoop:18088 ï¼ˆdef:8088ï¼‰  |
| yarn.resourcemanager.webapp.https.address | octserver2.hadoop:18090(def:8090)     |
| mapreduce.jobhistory.webapp.address       | octserver2.hadoop:19898 (def:19888)   |
</code></pre>

<p>ç­‰å¾…å®‰è£…å®Œæˆ</p>

<p><img src="/static/posts/hdp_cluster_install/23.png" alt="WebUI" /></p>

<p>ç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹æˆåŠŸå®‰è£…å®Œæˆæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œ</p>

<p><img src="/static/posts/hdp_cluster_install/24.png" alt="WebUI" /></p>

<p>æœ€ç»ˆç»“æœç•Œé¢ç±»ä¼¼å¦‚ä¸‹ï¼š</p>

<p><img src="/static/posts/hdp_cluster_install/25.png" alt="WebUI" /></p>
        </div>

    </div>

</div>


<nav aria-label="Page navigation">
    <ul class="pager">
        
        <li class="previous"><a href="/2019/08/31/docker_install_smtp_server/">
            <span aria-hidden="true">&larr;</span>ä½¿ç”¨dockeræ­å»ºsmtpæœåŠ¡</a></li>
        

        
        <li class="next"><a href="/2019/09/11/docker_ca/">
            Dockerå¼€å¯2376ç«¯å£ä½¿ç”¨CAè®¤è¯<span aria-hidden="true">&rarr;</span></a></li>
        
    </ul>
</nav>



<div class="reward" id="reward">

    <div class="reward-comment">
         <span> ğŸğŸè¿˜æ˜¯è¦æ”¾çš„ï¼Œä¸‡ä¸€çœŸæœ‰äººæ”¯æŒå˜ï¼ğŸ¤£ğŸ¤£ğŸ¤£</span>
    </div>

    
    <button type="button" class="btn btn-primary btn-lg reward-button" data-toggle="modal" data-target="#myModal">
        æ”¯æŒä¸€ä¸‹
    </button>

    
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">æ¥æ¯å’–å•¡</h4>
                </div>
                <div class="modal-body">
                    <div class="reward-body" id="reward-body">

                        <div class="row">
                            <div class="col-xs-6">
                                
                                <div class="reward-qr">
                                    <img src="/images/WeChatPay.png" alt="wechatpay_qrcode" class="img-responsive img-thumbnail">
                                    <span>å¾®ä¿¡</span>
                                </div>
                            </div>
                            <div class="col-xs-6">
                                
                                <div class="reward-qr">
                                    <img src="/images/AliPay.png" alt="wechatpay_qrcode" class="img-responsive img-thumbnail">
                                    <span>æ”¯ä»˜å®</span>
                                </div>
                            </div>
                        </div>


                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

</div>





<div class="comments" id="comments">
    

    <script src="https://utteranc.es/client.js"
        repo="wevsmy/wevsmy.github.io"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>

    
</div>




                
            </div>
            
            <aside class="sidebar" id="sidebar" style="background: url(/images/background.png);">

    <div class="info sidebar-item" id="info">

        
        
        <img class="author-avatar" src="/images/avatar.png" alt="wilson">
        
        

        <h2 class="author-name">wilson</h2>
        <h3 class="author-description">Ù©(à¹‘â›á´—â›à¹‘)Û¶</h3>
        <div class="site-count">
            
            
            
            
            
            <div class="count-block">
                <div class="site-count-title">å½’æ¡£</div>
                <div><a href="/posts/">82</a></div>
            </div>
            
            
            
            <div class="count-block">
                <div class="site-count-title">åˆ†ç±»</div>
                <div><a href="/categories/">2</a></div>
            </div>
            
            
            
            <div class="count-block">
                <div class="site-count-title">æ ‡ç­¾</div>
                <div><a href="/tags/">
                    
                    
                    
                    
                    
                    
                    
                    
                    29
                </a></div>
            </div>
            
            
            
            
        </div>

        <div class="rss">
            <a class="btn rss-link" href="https://blog.weii.ink/index.xml"
               type="application/rss+xml" title="rss">
                <i class="iconfont iconrss rss-icon"> RSS</i>
            </a>
        </div>

    </div>

    <div class="sidebar-sticky">

        
        
        <hr>
        <div class="post-toc sidebar-item">
            <div><i class="iconfont iconorderedlist"></i> æ–‡ç« ç›®å½•</div>
            <nav id="TableOfContents">
<ul>
<li><a href="#hdp-2-6-5-é›†ç¾¤å®‰è£…è®°å½•">HDP(2.6.5)é›†ç¾¤å®‰è£…è®°å½•</a>
<ul>
<li><a href="#ç½‘ç»œé…ç½®-æ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œ">ç½‘ç»œé…ç½®(æ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œ)</a></li>
<li><a href="#å®‰è£…jdk">å®‰è£…JDK</a></li>
<li><a href="#ambariå®‰è£…">Ambariå®‰è£…</a></li>
<li><a href="#å®‰è£…mysql">å®‰è£…Mysql</a></li>
<li><a href="#webuié…ç½®">WebUIé…ç½®</a></li>
</ul></li>
</ul>
</nav>
        </div>
        
        
        <hr>
        <div class="social-link sidebar-item">
            <div><i class="iconfont iconidcard"></i> ç¤¾äº¤é“¾æ¥</div>
            <ul>
                
                <li>
                    <a href="https://github.com/wevsmy" data-toggle="tooltip" data-placement="top"
                       title="O__O ">
                        <i class="iconfont icongithub-fill"></i> GitHub
                    </a>
                </li>
                
                <li>
                    <a href="https://weibo.com/wevsmy" data-toggle="tooltip" data-placement="top"
                       title="O__O ">
                        <i class="iconfont iconweibo"></i> Weibo
                    </a>
                </li>
                
                <li>
                    <a href="mailto:wevsmy@gmail.com" data-toggle="tooltip" data-placement="top"
                       title="O__O ">
                        <i class="iconfont iconmail"></i> E-Mail
                    </a>
                </li>
                
            </ul>
        </div>
        <hr>
        <div class="blogroll sidebar-item">
            <div><i class="iconfont iconlink"></i> å‹æƒ…é“¾æ¥</div>
            <ul>
                
                <li>
                    <a href="https://blog.weii.ink" target="_blank" data-toggle="tooltip" data-placement="top"
                       title="â•®(â•¯â–½â•°)â•­">
                        <i class="iconfont iconcode"></i> wilson&#39;s blog
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/wevsmy" target="_blank" data-toggle="tooltip" data-placement="top"
                       title="O__O ">
                        <i class="iconfont icongithub-fill"></i> GitHub
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/wevsmy" target="_blank" data-toggle="tooltip" data-placement="top"
                       title="O__O ">
                        <i class="iconfont iconheart"></i> å‹é“¾æ‹›ç§ŸğŸ¤ª
                    </a>
                </li>
                
            </ul>
        </div>
    </div>

</aside>

        </div>
    </div>
</main>


<footer id="footer" class="footer" 
        style="background: #333333;" >

    <div class="container">
        <div class="back-to-top">
            <a href="#top">
                <button id="back-to-top">
                    <i class="iconfont iconrocket back-to-top-i" aria-label="true"></i>
                </button>
            </a>
        </div>

        <div class="footer-container">
            <div class="footer-left">
                <div class="copyright">
                    <span class="author">
                        <a href="https://blog.weii.ink" target="_blank">
                            <abbr title="(â‰§Oâ‰¦)" data-toggle="tooltip" data-placement="top">
                                wilson
                            </abbr>
                        </a>
                    </span>
                    <i class="iconfont iconheart" aria-hidden="true"></i>
                    <span class="year">2014 - 2019</span>
                    
                    <span class="creative-commons">
                        <i class="iconfont iconcopyright" aria-hidden="true"></i>
                        <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/"
                           target="_blank">BY-NC-SA 4.0</a>
                    </span>
                    
                </div>
                
                <div class="busuanzi">
                    <span id="busuanzi_container_site_pv">
                        <i class="iconfont iconeye" aria-label="ç«™ç‚¹ç‚¹å‡»é‡" aria-hidden="false"></i>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                    <span id="busuanzi_container_site_uv">
                        <i class="iconfont iconuser" aria-label="ç«™ç‚¹ç”¨æˆ·æ•°" aria-hidden="false"></i>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                    <span id="busuanzi_container_page_pv">
                        <i class="iconfont iconsolution"></i>
                        <span id="busuanzi_value_page_pv" aria-label="é¡µé¢ç‚¹å‡»é‡" aria-hidden="false"></span>
                    </span>
                </div>
                


            </div>
            <div class="footer-right">
                <div class="custom-info">
                    <a href="/sitemap.xml" target="_blank">SiteMap</a>
                    <i class="iconfont icongithub-fill"></i>
                    <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
                    <iframe style="margin-left:2px;margin-bottom:-5px;"
                            frameborder="0" scrolling="0" width="82px"
                            height="20px"
                            src="https://ghbtns.com/github-btn.html?user=wevsmy&repo=hugo-theme-weii&type=star&count=true">
                    </iframe>
                </div>

                <div class="powered-by">ç”±
                    <a href="https://gohugo.io" target="_blank">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ç§»æ¤
                    <a href="https://github.com/wevsmy/hugo-theme-weii" target="_blank">WEII</a> | é¸£è°¢
                    <a href="https://github.com/AlynxZhou/hexo-theme-aria" target="_blank">ARIA</a>
                </div>

            </div>
        </div>
    </div>
</footer>









<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>







<script type="text/javascript" color="0,0,255" opacity='0.7' zIndex="-2" count="99" src="/js/canvas-nest.js"></script>





<script type="text/javascript" src="/js/love.js"></script>




<script type="text/javascript" src="/js/weii.js"></script>
</body>
</html>